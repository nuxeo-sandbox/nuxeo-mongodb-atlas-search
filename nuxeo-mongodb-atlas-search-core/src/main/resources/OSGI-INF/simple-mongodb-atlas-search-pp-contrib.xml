<?xml version="1.0"?>
<component name="org.nuxeo.labs.atlas.search.pp">

    <require>org.nuxeo.ecm.core.CoreExtensions</require>

    <extension point="providers" target="org.nuxeo.ecm.platform.query.api.PageProviderService">

        <genericPageProvider class="org.nuxeo.labs.atlas.search.pp.MongoDBAtlasSearchPP"
                             name="simple-atlas-search">
            <trackUsage>false</trackUsage>
            <property name="coreSession">#{documentManager}</property>
            <whereClause>
                <fixedPart>ecm:mixinType != 'HiddenInNavigation' AND ecm:isVersion = 0 AND ecm:isTrashed = 0</fixedPart>
            </whereClause>
            <pageSize>10</pageSize>
            <aggregates>
                <aggregate id="ecm_primarytype_agg" type="terms" parameter="ecm:primaryType">
                    <field name="title" schema="dublincore"/>
                    <properties>
                        <property name="size">10</property>
                    </properties>
                </aggregate>
            </aggregates>
        </genericPageProvider>
    </extension>

</component>
